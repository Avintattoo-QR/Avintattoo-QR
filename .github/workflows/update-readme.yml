name: Update README with Redirect Info

on:
  push:
    branches:
      - main  #  驻注  驻注 砖转砖 转 拽
  workflow_dispatch: # 驻砖专  驻注 转   转

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write # 转  专砖转 转 专

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Extract URL and Update README
        run: |
          # 砖驻转 转转 转 拽抓 -index.html
          TARGET_URL=$(grep -oP 'const targetUrl = "\K[^"]+' index.html)
          LAST_UPDATE=$(date +'%d/%m/%Y %H:%M')

          # 爪专转 转 -README
          echo "#  Avintattoo Dynamic QR Code" > README.md
          echo "" >> README.md
          echo "专   转 拽砖专  注专 -QR 拽 砖 住." >> README.md
          echo "" >> README.md
          echo "###  注 驻 :" >> README.md
          echo "[$TARGET_URL]($TARGET_URL)" >> README.md
          echo "" >> README.md
          echo " **注 专:** $LAST_UPDATE" >> README.md
          echo "" >> README.md
          echo "---" >> README.md
          echo "*-README  转注 转 注  GitHub Actions  驻注 砖砖 转 注 驻.*" >> README.md

      - name: Commit and Push changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "Bot: Updated README with latest redirect info" || echo "No changes to commit"
          git push
